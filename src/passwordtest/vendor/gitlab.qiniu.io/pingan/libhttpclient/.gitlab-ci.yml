image: golang:1.9.0
test:
  before_script:
    - echo 'nameserver 114.114.114.114' >> /etc/resolv.conf
    - echo 'nameserver 8.8.8.8' >> /etc/resolv.conf
  script:
    - |
      echo 'deb http://mirrors.aliyun.com/debian/ stretch main non-free contrib' > /etc/apt/sources.list
      apt-get update -y
      apt-get install -y golang-glide
    - mkdir -p /go/src/gitlab.qiniu.io/pingan/
    - cp -r . /go/src/gitlab.qiniu.io/pingan/libhttpclient
    - |
      cd /go/src/gitlab.qiniu.io/pingan/libhttpclient
      glide install -v
      go test -v ./...
